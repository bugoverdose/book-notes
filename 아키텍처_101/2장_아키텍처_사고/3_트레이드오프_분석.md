## 3 트레이드오프 분석

아키텍트처럼 생각하는 것은 기술 여부와 상관없이 모든 솔루션의 트레이드오프를 분석하여 최선의 솔루션을 결정하는 것.

> 마크: "아키텍처는 구글링해도 안 되는 것이다"
> 닐: "아키텍처는 정답도, 오답도 없다. 오직 트레이드오프만 있을 뿐."
> Rich Hickey: 프로그래머는 장점은 잘 알지만 트레이드오프는 하나도 모른다. 아키텍트는 둘 다 잘 알아야 한다.

아키텍처는 모든 것이 트레이드오프이므로 질문에 따라 "경우에 따라 다릅니다(it depends)"라고 답하는 것이 일반적.

- REST vs 메시징, 마이크로서비스가 적절한지 등은 정말 경우에 따라 다름.
- 배포 환경, 비즈니스 동인, 회사 문화, 예산 기간, 개발자 스킬 세트 등 여러 팩터들이 영향을 미침.

### 메시징 구현 방안: 토픽 vs 큐

아키텍트는 특정한 비즈니스 요구사항이 주어졌을 때 다양한 방안별 트레이드오프를 분석하고 주어진 상황에서 가장 나은 선택을 해야함!

- 토픽을 사용한 메시지 발행/구독 모델

  - 장점1. 아키텍처 신장성(extensibility). 프로듀서가 하나의 토픽에 한번만 연결되면 됨. 새로운 서비스/기능을 도입하더라도 기존 시스템은 전혀 고칠 필요가 없는 구조.
  - 장점2. 서비스 디커플링. 프로듀서에서는 어떤 서비스들이 구독하고 있는지 모르므로 커플링도 낮음!
  - 단점1: 토픽은 도청하기 쉬우므로 데이터 보안 문제 가능. 구독하는 쪽에서는 누구나 토픽의 데이터에 접근 가능하므로.
  - 단점2: 토픽은 한가지 계약(contract)만 지원하므로 수신하는 모든 서비스는 무조건 동일한 데이터 세트를 받아야 함. 특정 서비스를 위해 다른 모든 서비스에서 사용하는 데이터 형식을 수정해야 함.
  - 단점3: 토픽의 메시지 개수 모니터링 불가.
  - 단점4: 자동 확장(auto-scaling)이 지원되지 않음.

- 큐를 사용한 점대점 메시징 모델
  - 장점1: 보안. 큐에 전달된 데이터는 해당 큐를 수신하는 지정된 컨슈머에서만 접근 가능. 도청하기 어려움.
  - 장점2: 각 큐 솔루션별로 각 컨슈머가 필요로 하는 커스텀한 계약/데이터 세트를 지닐 수 있음.
  - 장점3: 각 큐를 별도로 모니터링 가능.
  - 장점4: 컨슈머마다 개별적으로 로드 밸런싱 로직을 적용하여 상호 독립적인 자동 확장이 가능함.
  - 단점: 새로운 서비스 도입시, 기존 인프라를 변경해야 함.

이처럼 각 솔루션의 장점/단점들의 트레이드오프를 분석하고, 비즈니스 동인, 환경 등 다양한 팩터를 고려하여 현재 어떤 솔루션이 더 적합한지 판단 필요함.
