## 사례 연구: 실리콘 샌드위치

실리콘 샌드위치 카타 - 요구사항에서 아키텍처 특성 도출 연습

- 설명: 기존의 매장 서비스와 병행하여 온라인 주문 시스템을 구축
- 유저: 수천~수백만명 예상
- 요구사항
  - 교통 정보 등 각종 외부 지도 서비스와의 연계 필수. 유저가 주문을 하면 샌드위치를 픽업하러 갈 시간 및 상점까지 가는 경로를 전달받아야 함.
  - 배달 가능한 지점에는 기사를 보내 샌드위치를 유저에게 배달함.
  - 모바일 기기 이용 가능.
  - 전국 어느 지점에서나 이용 가능한 프로모션/스페셜 행사 제공.
  - 특정 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사 제공.
  - 온라인, 대면 등 다양한 결제 옵션 제공.
- 부가 컨텍스트
  - 각 지점은 가맹점이므로 소유자가 전부 다름
  - 모회사는 향후 해외 시장에 진출할 계획
  - 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표

이러한 시나리오가 주어지면 아키텍처 특성이 될 만한 것들을 명시적인 것과 암묵적인 것으로 분류 필요.

### 명시적 특성

명시적 아키텍처 특성은 설계의 일부로서 요구사항 정의서에 명시적으로 기술됨.

#### 확장성과 탄력성 도출

- 유의미한 성능 저하 없이 다수의 동시 유저를 처리할 수 있도록 `확장성` 고려 필수! 점진적으로 유저 수가 늘어났을 때 증가한 만큼 문제 없이 대응할 수 있도록.
  - 유저 수가 현재는 수천 명이지만 향후 수백만명에 이를 수 있다고 명시되었으므로 필요!
- 순간적으로 유저 요청이 폭증했을 때 처리할 수 있도록 `탄력성`도 필수! 순간적으로 요청이 오르내릴 때 전부 감당 가능하도록.
  - 샌드위치 지점의 사용 트래픽은 식사 시간 전후로 급증하므로 탄력성 필요!

ex) 호텔 예약 시스템의 경우, 확장성은 좋아야하지만 탄력적일 필요가 없음. 투숙객 수가 대체로 일정하므로.
ex) 콘서트 티켓 예약 시스템의 경우, 확장성이 높으면서 탄력적이어야 함! 트래픽 폭증 및 엄청난 동시 유저 접속을 처리할 수 있어야 함.

#### 요구사항별 특성 도출

- 교통 정보 등 각종 외부 지도 서비스와의 연계 지점은 `신뢰성`에 영향 미칠 수 있음.

  - 서드파티에 의존하는 경우 서드파티 시스템 호출이 실패할 경우 전체 시스템 안정성이 타격을 입음. 이때 서비스 전체를 다운시킬 것인가, 아니면 해당 기능만 쓸 수 없는 덜 유용한 서비스를 사용자에게 제공할 것인가?
  - 불필요한 불안정성 취약점이 설계에 반영되지 않도록 아키텍트는 과도하게 아키텍처 특성을 설정하지 않도록 유의해야 함.

- 배달 가능한 지점에는 기사를 보내 샌드위치를 유저에게 배달함. => 특별한 아키텍처 특성과 무관

- 모바일 기기 이용 가능.

  - 클라이언트를 어떠한 기술 스택으로 개발할 것인가와 관련된 의사결정 필요. 이식성 좋은 웹 애플리케이션 vs 네이티브 웹 애플리케이션 등

- 전국 어느 지점에서나 이용 가능한 프로모션/스페셜 행사 제공 & 특정 지점에서만 이용 가능한 로컬 프로모션/스페셜 행사 제공 => `맞춤성(customizability)` 도출 가능.

- 온라인, 대면 등 다양한 결제 옵션 제공. => `보안`이 필요하겠으나, 어느 정도 수준으로 중요할지는 불확실.

- 각 지점은 가맹점이므로 소유자가 전부 다름 => 아키텍처 비용에 제약을 가하는 요구사항. `타당성(feasibility)` 확인 필요(비용, 시간, 직원 스킬 세트 등의 제약조건)

- 모회사는 향후 해외 시장에 진출할 계획 => `국제화`(i18n) 필요.

- 회사는 값싼 인력을 고용해 이윤을 최대화하는 것이 목표 => `사용성`이 중요.

그 외에도 `성능` 필요. `확장성 수(scalability number)`와 `성능 수(performance number)`를 정의함으로써 성능의 기준선을 먼저 그어놓고 특정 수의 유저가 접속할 때 성능의 하한성이 어느 정도인지 정해야 함.

### 암묵적 특성

시스템에서 마땅히 지원되어야 할 암묵적인 아키텍처 특성들

- 서비스에 접속가능해야 하므로 `가용성(availability)` 필요.
- 서비스를 문제없이 사용할 수 있도록 `신뢰성(reliability)` 필요.
- `보안`의 경우 설계의 구조적인 측면에 영향을 미치거나, 애플리케이션에 매우 중요한 요소로 판단되는 경우 아키텍처 특성으로 간주.

실리콘 샌드위치 카타에서는 `맞춤성`이 필요.

- 맞춤성은 설계인가, 아키텍처인가?
- **아키텍처는 구조적 컴포넌트. 설계는 아키텍처 내부에 속함.**
- 대체로 애플리케이션의 설계 범주에 속할 수 있지만, 커스터마이징한 구조에 의존하는 문제라면 아키텍처 특성이 됨.
- 마이크로커널 아키텍처로 구현할 경우 아키텍처 / 템플릿 메서드 패턴 같은 패턴으로 로직 구현시 설계 => 각각의 트레이드오프에 대해 분석하여 비교 필요. 또한 아키텍트는 개발자, 프로젝트 관리자, 운영팀, 기타 시스템 구축에 참여한 사람들의 협조를 구해야 하므로 혼자서 결정할 수 없음.

### 정리

개발자 입장에서는 어떠한 방법을 쓰더라도 기능을 구현할 수 있으므로 아키텍트는 **아키텍처 특성을 최대한 정확하게 발견하려고 너무 스트레스 받을 필요는 없음!** 아키텍처에서 최고의 설계는 없고, 오직 가장 덜 나쁜 트레이드오프들만 존재할 뿐.

아키텍처 특성들에 우선순위를 매겨 가장 단순한 필수 세트로 정리해야 함. 시스템의 성공에 있어 가장 덜 중요한 것들을 솎아냄으로써 꼭 필요한 것들을 결정할 수 있게 됨.

시스템의 성공에 있어 가장 덜 중요한 것이 성능이라면, 상대적으로 다른 특성들보다 성능을 덜 우선시하는 애플리케이션을 구축해야 함.

---

## 노트

`아키텍트는 어느 한 아키텍처 특성을 지나치게 적용하는(over-specify) 함정에 빠지기가 쉬운데, 그 결과 시스템이 너무 복잡하게 설계되어 모자라게 적용하는(under-specify) 것만큼이나 해를 끼치는 경우가 많습니다.`(p111)

`아키텍처 특성을 선택하는 문제에 있어서 정답은 없으며 오직 잘못된 선택만 있을 뿐`(p111)

`상아탑 아키텍트(Ivory Tower Architect) 안티패턴`: 프로젝트 팀원들이 어떻게 개발하든 상관않고 자기만의 세계에 갇혀 설계하는 아키텍트.
