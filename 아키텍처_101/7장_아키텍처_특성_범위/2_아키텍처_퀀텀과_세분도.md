## 아키텍처 퀀텀과 세분도

성공적으로 소프트웨어를 설계, 분석, 발전시키기 위해 개발자는 문제가 될 만한 커플링 지점을 모두 살펴봐야 함.

- 소프트웨어를 서로 엮는 것은 컴포넌트 레벨의 커플링만이 아님.
- 많은 비즈니스 개념이 의미상 여러 시스템 파트를 한데 엮어 기능적으로 응집(functional conhesion)되어 있음.

퀀텀: (물리학) 상호작용을 하는 모든 물리 입자 가운데 가장 작은 양. (라틴어) how much, how great.

---

아키텍처 퀀텀 개념은 아키텍처 특성의 새로운 범위를 제시함.

현대 아키텍트들은 **시스템 레벨보다는 퀀텀 레벨의 아키텍처 특성을 정의**함. 중요한 운영 관심사에 대해 범위를 좁혀보면 중요한 아키텍처 문제를 조기에 발견하고 하이브리드 아키텍처를 설계할 수도 있음!

**아키텍처 퀀텀(architecture quantum)**: 높은 기능 응집도(high functional cohesion)와 동기적 커네이선스(synchronous connascence)를 지닌, 독립적으로 배포 가능한(independently deployable) 아티팩트

- `독립적으로 배포 가능한(independently deployable)`

  - 아키텍처 퀀텀은 다른 파트와 독립적으로 작동하는 모든 필수 컴포넌트를 포함함
  - DB를 사용하는 애플리케이션은 DB까지가 퀀텀의 일부.
  - 단일 DB를 사용하여 배포된 시스템의 아키텍처 퀀텀은 1
  - 마이크로서비스 아키텍처는 서비스마다 DB를 별도로 지니므로 퀀텀이 여러개가 됨

- `높은 기능 응집도(high functional cohesion)`

  - `응집도`: 컴포넌트 설계에 따라 구현된 코드가 목적에 맞게 통합되어있는 정도
    - Customer 컴포넌트는 "고객"과 관련된 모든 속성과 메서드를 지니므로 응집도가 높음.
    - Utility 컴포넌트는 잡다한 메서드를 무작위로 섞어놓으므로 응집도가 낮음.
  - `높은 기능 응집도`: **아키텍처 퀀텀이 목적에 맞는 무언가를 하고 있는 것**
    - 모놀리틱 애플리케이션에서는 의미가 없음.
    - 마이크로서비스 아키텍처에서는 개발자가 각 서비스를 하나의 워크플로우에 맞게 설계하므로 기능 응집도가 높게 나타남.

- `동기적 커네이선스(synchronous connascence)`

  - **아키텍처 퀀텀을 형성하는 애플리케이션 컨텍스트 내부의 동기 호출 OR 분산 서비스 간의 동기 호출**
  - 마이크로서비스 아키텍처에서 동기 호출은 호출의 길이에 대해 동적 커네이선스를 만들어냄. 즉, 한쪽이 다른 쪽을 기다린다면, 호출하는 도중에는 양쪽의 운영 아키텍처의 특성이 동일해야 함.
  - Payment와 Auction 서비스로 구성된 마이크로서비스 아키텍처 예시.
    - Auction 서비스에서 경매가 끝나면 Payment 서비스로 결제 정보 전달.
    - **엄청나게 많은 경매가 일시 종료되는 경우**, 아키텍처가 제대로 설계되지 않았다면 첫번째 호출만 성공하고, 나머지는 전부 타임아웃이 뜰 것!
    - 해결 방안: Payment와 Auction 간에 비동기 통신 링크를 만들고 **메시지 큐가 일시적인 버퍼 역할을 수행**하도록 설계하면 비동기적 커네이선스 덕분에 아키텍처가 한층 더 유연해짐!

### cf) 도메인 주도 설계의 경계 컨텍스트

- DDD: 복잡한 문제 도메인을 체계적으로 분해하는 모델링 기법.
- DDD의 경계 컨텍스트(bounded context)
  - 도메인에 관한 모든 것이 내부에서는 보이지만, 외부의 다른 경계 컨텍스트에서는 보이지 않음.
  - 비교) 사내 공통 엔티티를 개발자들이 자유롭게 재사용하는 경우, 커플링이 심해지고 복잡도 증가. BAD.
  - 각 문제 도메인에 자체 클래스를 두고 차이점은 그것을 통합하는 지점에서 조정하는 것이 경계 컨텍스트!
