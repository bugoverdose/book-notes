### 응집

응집(cohesion): 한 모듈의 구성요소/파트가 동일한 모듈 안에 포함되어있는 정도. 모듈의 구성요소가 서로 연관된 정도.

- 가장 이상적으로 응집된 모듈은 서로 연관된 모든 파트가 함께 패키징되어있음.

> Larry Constantine: **응집된 모듈을 나누려고 해봐야 더 커플링되고 가독성은 떨어진다.**

#### 응집도의 측정 범위

가장 이상적인 응집부터 가장 나쁜 순으로 나열.

1. 기능적 응집(functional cohesion): 모듈의 각 파트는 다른 파트와 연관되어있으며, 기능상 꼭 필요한 모든 것이 모듈에 포함됨.

2. 순차적 응집(sequential cohesion): 특정 모듈에서 출력하는 데이터를 다른 모듈에서 입력 받는 형태로 두 모듈이 상호작용함.

3. 소통적 응집(communication cohesion): 두 모듈이 각자 정보에 따라 작동하고, 특정 출력을 내는 형태로 커뮤니케이션 체인을 형성함.

   - ex. DB에 레코드를 추가하면 그 정보에 따라 이메일이 만들어지는 등

4. 절차적 응집(procedural cohesion): 두 모듈이 정해진 순서에 따라 실행되어야 함.

5. 일시적 응집(temporal cohesion): 모듈들이 시점 의존성(timing dependency)에 따라 연관됨.

   - ex. 서로 관련성이 없어보이는 것들이 순차적으로 초기화되는 등

6. 논리적 응집(logical cohesion): 모듈의 내부 데이터가 기능이 아닌 논리적으로 연관됨. 서로 연관된 작업들이지만 실제로 하는 작업은 전혀 다름.

   - ex. 자바의 StringUtils 패키지. 다른 작업을 수행하는 정적 메서드가 많지만 서로 연관성은 없음.
   - ex. 텍스트, 직렬화 객체, 스트림 형태로 받은 데이터를 변환하는 모듈

7. 동시적 응집(coincidential cohesion): 같은 소스 파일에 모듈 구성 요소가 들어있지만, 그 외에는 아무 연관성도 없음. 가장 좋지 않은 형태의 응집.

#### 응집도의 측정

모듈의 응집도는 아키텍트 재량에 따라 다르게 측정됨. 커플링에 비해 덜 정확한 메트릭.

연관된 기능을 전부 하나의 모듈로 관리할지, 두 개의 모듈로 관리할지는 트레이드오프 분석이 필요함. 상황에 따라 더 합리적인 구성이 달라짐.

#### LCOM(Lack of Cohesion Methods)

`LCOM = 공유 필드를 통해 공유되지 않는 메서드의 총 개수`

- 카이댐버와 케메러가 개발한 `메서드의 응집 결여도`(LCOM)는 모듈(컴포넌트)의 구조적 응집도를 나타냄.
- 객체 지향 소프트웨어 시스템의 특정 부분을 측정하는 메트릭 세트.
- 기본적으로 클래스 내부의 부차적인 커플링을 나타냄.

1. LCOM은 아키텍처 스타일 전환을 위해 코드베이스를 분석할 때 유용하게 사용 가능.

   - 어쩔 수 없이 커플링된 클래스, 처음부터 한 클래스가 아니었던 클래스 발견에 도움이 됨.

2. LCOM의 단점: 구조적 응집 결여도만 측정 가능. 어떤 파트들이 서로 잘 맞는지 논리적으로 판단 불가능.

3. LCOM 적용 예시들

   - private 필드 a,b가 있는 클래스에서 a만 접근하는 메서드와 b만 접근하는 메서드가 있는 경우, 공유 필드(a,b)를 통해 공유되지 않는 메서드가 많은걸로 측정됨 => LCOM 점수는 높음. 메서드의 응집 결여도가 높음. LOW 응집도.

   - LCOM 점수가 높고 구조적 응집이 나쁜 클래스. LOW 응집도: 메서드1은 필드 a만 접근, 메서드2은 필드 b만 접근, 메서드3은 필드 c만 접근 => 각 필드/메서드 쌍을 3개의 클래스로 분리해도 됨.

   - LCOM 점수가 낮고 구조적 응집이 우수한 클래스. HIGH 응집도: 메서드1은 필드 b,c 접근, 메서드2은 필드 a,b 접근, 메서드3은 필드 c만 접근 => 별도의 클래스로 분리하기 어려운 구조.

   - 응집이 조합된 클래스: 메서드1은 필드 a,b 접근, 메서드2은 필드 a만 접근 / 메서드3은 필드 c만 접근 => 메서드3과 필드c만 별도의 클래스로 분리해도 무관.
